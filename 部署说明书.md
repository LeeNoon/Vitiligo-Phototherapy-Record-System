# 部署指南 (Deployment Guide)

## 方式一：最简单的直接运行 (推荐)

这种方式最简单，适合个人使用或临时测试。

1. **生成发布包**
   - 在开发电脑上，双击运行 `生成发布包.bat`。
   - 等待完成后，会生成一个 `PublishOutput` 文件夹。

2. **上传到服务器**
   - 将 `PublishOutput` 文件夹完整复制到您的 Windows 服务器（例如复制到 `C:\VitiligoSystem`）。

3. **启动网站**
   - 进入文件夹，双击运行 `VitiligoTracker.exe`。
   - 看到黑框出现即表示启动成功。
   - 默认访问地址：`http://localhost:5000` (如果使用 Docker 部署则为 `http://localhost`)
   - 如果需要通过公网 IP 访问，请确保服务器防火墙开放了对应端口。

---

## 方式二：使用 IIS 部署 (专业方式)

如果您希望网站作为后台服务一直运行，并且使用 80 端口（无需输入端口号），建议使用 IIS。

### 1. 准备工作
- 确保服务器已安装 **IIS (Internet Information Services)**。
- 确保服务器安装了 **ASP.NET Core Hosting Bundle** (即使是独立发布，安装这个模块能让 IIS 更好地托管 .NET 程序)。
  - [下载 Hosting Bundle](https://dotnet.microsoft.com/permalink/dotnetcore-current-windows-runtime-bundle-installer)

### 2. 配置 IIS
1. 打开 **IIS 管理器**。
2. 右键 "网站" -> "添加网站"。
3. **网站名称**：VitiligoTracker
4. **物理路径**：选择您上传的 `PublishOutput` 文件夹路径。
5. **端口**：80 (或其他您想要的端口)。
6. 点击确定。

### 3. 修改应用程序池 (重要)
1. 在 IIS 左侧点击 "应用程序池"。
2. 找到刚才创建的 `VitiligoTracker`。
3. 双击它，将 **.NET CLR 版本** 设置为 **"无托管代码" (No Managed Code)**。
4. 确定保存。

现在，您可以通过服务器的 IP 地址直接访问网站了。

---

## 常见问题

**Q: 数据库在哪里？**
A: 数据库文件是 `vitiligo.db`。部署后，它会自动在运行目录下生成。如果您想保留之前的记录，请将开发电脑上的 `vitiligo.db` 也复制到服务器的文件夹中。

**Q: 如何修改端口？**
A: 打开 `appsettings.json` 文件，添加如下配置：
```json
"Kestrel": {
  "Endpoints": {
    "Http": {
      "Url": "http://*:8080"
    }
  }
}
```
这样就会运行在 8080 端口。
